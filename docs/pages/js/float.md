# JavaScript æµ®ç‚¹æ•°é™·é˜±

![](/js/float/banner.jpg)

## å‰è¨€

&emsp;&emsp;;`JavaScript`ä¸­çš„æµ®ç‚¹æ•°ç»å¸¸ä¼šæœ‰å¥‡æ€ªçš„è¿ç®—ç»“æœï¼Œä¾‹å¦‚`0.1 + 0.2 != 0.3`æˆ–è€…æ˜¯`1.005.toFixed(2)`ç»“æœä¸º`1.00`ï¼Œåˆæˆ–è€…`Number.MAX_VALUE`ä¸`Number.MAX_SAFE_INTEGER`çš„åŒºåˆ«ç­‰ç­‰ã€‚

&emsp;&emsp;æ­¤å¤„å¯¹`JavaScript`æµ®ç‚¹æ•°çš„å­˜å‚¨æ ‡å‡†å’Œä»¥ä¸Šç–‘é—®åšäº†æ¯”è¾ƒç»†è‡´çš„æ•´ç†ï¼Œå¸Œæœ›å¯¹ä½ æœ‰ç”¨ã€‚

## IEEE 754

&emsp;&emsp;;`JavaScript`ä¸å…¶å®ƒè¯­è¨€ä¸åŒï¼Œ`Number`ç±»å‹æ˜¯ä¸åŒºåˆ†æ•´å‹å’Œæµ®ç‚¹çš„ã€‚å¯¹äºæ‰€æœ‰çš„æ•°å­—åŒ…æ‹¬æ•´æ•°å’Œå°æ•°ç›¸åŒå­˜å‚¨ï¼Œéµå¾ª`IEEE 754`çš„åŒç²¾åº¦æ ‡å‡†ï¼Œ`64`ä½å›ºå®šé•¿åº¦ï¼Œä¹Ÿå³æ˜¯å¸¸è¯´çš„`double`ç±»å‹ã€‚

&emsp;&emsp;ç”±äºæ•´æ•°å’Œå°æ•°éƒ½é‡‡ç”¨`64`ä½å­˜å‚¨ï¼Œå¯¹äºå†…å­˜æ¥è¯´æ•´å‹å’Œæµ®ç‚¹å‹ä¹Ÿå°±æ²¡æœ‰åŒºåˆ«äº†ã€‚

> ä½è¿ç®—ä¸Šï¼Œä¼šå°†æ“ä½œæ•°è½¬ä¸º`32`ä½æœ‰ç¬¦å·æ•°ï¼Œå°æ•°éƒ¨åˆ†ç›´æ¥ä¸¢å¼ƒ

&emsp;&emsp;;`64`ä½æ¯”ç‰¹åŒ…æ‹¬ä¸‰ä¸ªéƒ¨åˆ†ã€‚

 - ç¬¦å·ä½ï¼ˆ`S`ï¼Œ`sign`ï¼‰ï¼šç¬¬`63`ä½ï¼Œ`0`è¡¨ç¤ºæ­£æ•°ï¼Œ`1`è¡¨ç¤ºè´Ÿæ•°
 - æŒ‡æ•°ä½ï¼ˆ`E`ï¼Œ`exponent`ï¼‰ï¼šç¬¬`52`åˆ°`62`ä½ï¼Œå…±`11`ä½ï¼Œå–å€¼èŒƒå›´ä¸º`0~2047`ã€‚ä½†æ˜¯æŒ‡æ•°ä½æ˜¯å¯ä»¥ä¸ºè´Ÿæ•°çš„ï¼Œåç§»`2023`åå–å€¼èŒƒå›´å˜ä¸º`[-1023, 1024]`
 - å°¾æ•°ä½ï¼ˆ`M`ï¼Œ`mantissa`ï¼‰ï¼šç¬¬`0`åˆ°`51`ä½ï¼Œå…±`52`ä½ã€‚

![](/js/float/ieee.png)

&emsp;&emsp;è®¡ç®—å…¬å¼ä¸ºã€‚

<LaTeX>V=(-1)^S2^{E-1023}(M+1)</LaTeX>

&emsp;&emsp;;`11.25`çš„`64`ä½è¡¨ç¤ºã€‚

 - å°†æ•´æ•°å’Œå°æ•°éƒ¨åˆ†è½¬æ¢æˆäºŒè¿›åˆ¶ï¼Œå³`11.25 = 1011.01`
 - ç§»åŠ¨å°æ•°ç‚¹ï¼Œä½¿å…¶ä½äºç¬¬`1`ã€`2`ä½ä¹‹é—´ï¼Œè§„èŒƒåŒ–ä¸º`1.01101 * 2 ^ 3`
 - `11.25`ä¸ºæ­£æ•°ï¼Œ`S = 0`ã€‚å¦å¤–æŒ‡æ•°ä¸º`3`ï¼Œåˆ™`E = 1023 + 3 = 1026`ï¼Œå³`100 0000 0010`
 - èˆå»æ•´æ•°éƒ¨åˆ†`1`ï¼Œå‰©ä¸‹å°¾æ•°éƒ¨åˆ†`01101`ï¼Œç©ºä½è¡¥`0`ï¼Œå³`0110 1000 ... 0000`ï¼ˆ`52`ä½ï¼‰
 - `11.25`çš„`64`ä½æµ®ç‚¹æ•°çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸º`0 10000000010 01101000...0000`

![](/js/float/11.25.png)

&emsp;&emsp;([å›¾ç‰‡æ¥æº](http://www.binaryconvert.com/convert_double.html))

> è§„èŒƒåŒ–åçš„æ•´æ•°éƒ¨åˆ†å¿…ç„¶ä¸º`1`ï¼Œå­˜å‚¨æ—¶å¯ä»¥çœç•¥ï¼Œåªè®°å½•å°æ•°ç‚¹ä¹‹åçš„éƒ¨åˆ†, ä¹Ÿå°±èŠ‚çº¦äº†ä¸€ä½å†…å­˜

## å°±è¿‘èˆå…¥

&emsp;&emsp;åœ¨å››èˆäº”å…¥ä¸­ï¼Œ`0 ~ 9`åä¸ªæ•°ï¼Œ`0`æ¯”è¾ƒç‰¹æ®Šï¼Œä¸ä¼šå­˜åœ¨èˆå»çš„æƒ…å†µï¼Œèˆä¸èˆå»éƒ½æ˜¯å½“å‰æ•°ã€‚è€Œå‰©ä¸‹çš„`9`ä¸ªæ•°ä¸­ï¼Œ`1 ~ 4`èˆå»ï¼Œ`5 ~ 9`ä¸Šå…¥ï¼Œæ¦‚ç‡ä¸Šèˆå»ä¸º`4 / 9`ï¼Œä¸Šå…¥ä¸º`5 / 9`ï¼Œå› æ­¤å¹¶ä¸æ˜¯å…¬å¹³çš„ã€‚

&emsp;&emsp;å°±è¿‘èˆå…¥ï¼Œæˆ–è€…å«é“¶è¡Œå®¶èˆå…¥ï¼Œæ˜¯å››èˆå…­å…¥äº”æˆåŒã€‚å³`1 ~ 4`èˆå»ï¼Œ`6 ~ 9`ä¸Šå…¥ï¼Œ`5`çš„æƒ…å†µåˆ™çœ‹å‰ä¸€ä½æ˜¯å¥‡æ•°è¿˜æ˜¯å¶æ•°ï¼Œå¶æ•°åˆ™èˆå»ï¼Œå¥‡æ•°åˆ™ä¸Šå…¥ï¼Œå› æ­¤æ¦‚ç‡éƒ½æ˜¯`50%`ï¼Œæ›´åŠ åˆç†ã€‚

&emsp;&emsp;äºŒè¿›åˆ¶ä¸­çš„å°±è¿‘èˆå…¥ï¼Œå…¶ä¸­`1001`å¤§äº`1000`åˆ™ä¸Šå…¥`1`ï¼Œ`0111`å°äº`1000`åˆ™èˆå»ï¼Œè€Œå¯¹äº`1000`çš„æƒ…å†µï¼Œçœ‹å‰ä¸€ä½æ˜¯å¥‡æ•°è¿˜æ˜¯å¶æ•°ï¼Œè‹¥ä¸º`0`åˆ™èˆå»ï¼Œä¸º`1`åˆ™ä¸Šå…¥`1`ã€‚

```javascript
1.001 1001 // 1.010
1.001 0111 // 1.001
1.001 1000 // 1.010

1.100 1001 // 1.101
1.100 0111 // 1.100
1.100 1000 // 1.100
```

## Number.MAX_VALUE

&emsp;&emsp;;[Number.MAX_VALUE](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_VALUE) å³`JavaScript`ä¸­æ‰€èƒ½è¡¨ç¤ºçš„æœ€å¤§æ•°å€¼ã€‚

&emsp;&emsp;æŒ‰ç…§`IEEE 754`çš„`64`ä½æ ‡å‡†ï¼Œå¯ä»¥æ˜æ˜¾æƒ³åˆ°ä»¥ä¸‹è¡¨ç¤ºã€‚

```javascript
0 11111111111 1111111111111111111111111111111111111111111111111111
```

&emsp;&emsp;ä½†æ˜¯æ³¨æ„æŒ‡æ•°ä½å…¨ä¸º`1`ç”¨æ¥è¡¨ç¤º`NaN`æˆ–`Infinity`ï¼Œå› æ­¤æŒ‡æ•°ä½æœ€å¤§ä¸º`111 1111 1110`ã€‚

```javascript
0 11111111110 1111111111111111111111111111111111111111111111111111
```

&emsp;&emsp;è½¬ä¸ºåè¿›åˆ¶ã€‚

```javascript
  1.1111111111111111111111111111111111111111111111111111 * 2 ^ (2046 - 1023)
= 1.1111111111111111111111111111111111111111111111111111 * 2 ^ 1023
= 1 1111111111111111111111111111111111111111111111111111 * 2 ^ (1023 - 52)
= 1 1111111111111111111111111111111111111111111111111111 * 2 ^ 971
= (2 ^ 53 - 1) * 2 ^ 971
= 1.7976931348623157e+308
```

&emsp;&emsp;ä¹Ÿå³æ˜¯`Number.MAX_VALUE`ã€‚

```javascript
(Math.pow(2, 53) - 1) * Math.pow(2, 971) // 1.7976931348623157e+308
(Math.pow(2, 53) - 1) * Math.pow(2, 971) === Number.MAX_VALUE // true
```

## Number.MAX_SAFE_INTEGER

&emsp;&emsp;;[Number.MAX_SAFE_INTEGER](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_SAFE_INTEGER) è¡¨ç¤º`JavaScript`ä¸­æœ€å¤§çš„å®‰å…¨æ•´æ•°ã€‚

&emsp;&emsp;;`Number.MAX_SAFE_INTEGER`äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œæ³¨æ„æŒ‡æ•°åˆšå¥½ä¸º`52`ã€‚

```javascript
0 10000110011 1111111111111111111111111111111111111111111111111111
```

&emsp;&emsp;è½¬ä¸ºåè¿›åˆ¶ã€‚

```javascript
  1.1111111111111111111111111111111111111111111111111111 * 2 ^ (1075 - 1023)
= 1.1111111111111111111111111111111111111111111111111111 * 2 ^ 52
= 1 1111111111111111111111111111111111111111111111111111
= 2 ^ 53 - 1
= 9007199254740991
```

&emsp;&emsp;ç„¶åæ¥è¯´è¯´ä¸ºä»€ä¹ˆå«å®‰å…¨æ•´æ•°ï¼ŒæŒ‡çš„æ˜¯å½“å‰æ•´æ•°è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ—¶ï¼Œå¯ä»¥å®Œå…¨å­˜å‚¨åœ¨å°¾æ•°ä½ä¸­ï¼Œä¸ä¼šå‘ç”Ÿèˆå…¥ã€‚

&emsp;&emsp;è€Œ`Number.MAX_SAFE_INTEGER + 1`å’Œ`Number.MAX_SAFE_INTEGER + 2`éƒ½ä¼šå­˜åœ¨èˆå»çš„æƒ…å†µã€‚

&emsp;&emsp;;`Number.MAX_SAFE_INTEGER + 2`ï¼Œ`9007199254740993`çš„äºŒè¿›åˆ¶è¡¨ç¤ºã€‚

```javascript
100000000000000000000000000000000000000000000000000001
```

&emsp;&emsp;è§„èŒƒåŒ–ã€‚

```javascript
1.00000000000000000000000000000000000000000000000000001 * 2 ^ 53
```

&emsp;&emsp;ç”±äºæŒ‡æ•°ä½åªèƒ½å®¹çº³`52`ä½ï¼Œä½ä½ä¸º`1`ä¸”å‰ä¸€ä½ä¸º`0`ï¼Œå°±è¿‘èˆå…¥æ—¶ä¼šè¢«èˆå»ã€‚

```javascript
0000000000000000000000000000000000000000000000000000(1)
0000000000000000000000000000000000000000000000000000
```

&emsp;&emsp;;`64`ä½æµ®ç‚¹æ•°è¡¨ç¤ºã€‚

```javascript
0 10000110100 0000000000000000000000000000000000000000000000000000
```

&emsp;&emsp;å¦å¤–`Number.MAX_SAFE_INTEGER + 1`ï¼Œä¹Ÿä¼šå­˜åœ¨èˆå»çš„æƒ…å†µã€‚

&emsp;&emsp;;`9007199254740992`çš„æµ®ç‚¹æ•°è¡¨ç¤ºã€‚

```javascript
0 10000110100 0000000000000000000000000000000000000000000000000000
```

&emsp;&emsp;å› æ­¤ä¼šé€ æˆä»¥ä¸‹ç»“æœã€‚

```javascript
Number.MAX_SAFE_INTEGER + 1 === Number.MAX_SAFE_INTEGER + 2 // true
```

## 0.1 + 0.2 != 0.3

### 0.1

&emsp;&emsp;å…ˆæ¥å°†`0.1`è½¬æ¢ä¸ºäºŒè¿›åˆ¶ï¼Œè¿ç»­ä¹˜ä»¥`2`å¹¶å–æ•´ã€‚

```javascript
0.1 * 2 = 0.2 ----- æ•´ 0 ä½™ 0.2
0.2 * 2 = 0.4 ----- æ•´ 0 ä½™ 0.4
0.4 * 2 = 0.8 ----- æ•´ 0 ä½™ 0.8
0.8 * 2 = 1.6 ----- æ•´ 1 ä½™ 0.6
0.6 * 2 = 1.2 ----- æ•´ 1 ä½™ 0.2
0.2 * 2 = 0.4 ----- æ•´ 0 ä½™ 0.4
```

&emsp;&emsp;;`0.1`çš„äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œ`0011`å°†æ— é™å¾ªç¯ä¸‹å»ã€‚

```javascript
0.0 0011 0011 0011 (0011)
```

&emsp;&emsp;è§„èŒƒåŒ–ï¼Œå¦å¤–`0.1`ä¸ºæ­£æ•°ï¼Œ`S = 0`ï¼ŒæŒ‡æ•°ä¸º`-4 + 1023 = 1019`ï¼Œå³`011 1111 1011`ã€‚

```javascript
1.1 0011 0011 (0011) * 2 ^ -4
```

&emsp;&emsp;å°¾æ•°ä½æœ€å¤šå­˜å‚¨`52`ä½ï¼Œä¸”é‡‡ç”¨å°±è¿‘èˆå…¥æ¨¡å¼ï¼Œå‘å‰è¿›`1`ã€‚

```javascript
1001100110011001100110011001100110011001100110011001(10011)
1001100110011001100110011001100110011001100110011010
```

&emsp;&emsp;;`0.1`çš„`64`ä½æµ®ç‚¹æ•°è¡¨ç¤ºã€‚

```javascript
0 01111111011 1001100110011001100110011001100110011001100110011010
```

![](/js/float/0.1.png)

### 0.2

&emsp;&emsp;;`0.2`çš„äºŒè¿›åˆ¶ã€‚

```javascript
0.0011 0011 0011 (0011)
```

&emsp;&emsp;è§„èŒƒåŒ–`0.2`ï¼Œ`S = 0`ï¼ŒæŒ‡æ•°ä¸º`-3 + 1023 = 1020`ï¼Œå³`011 1111 1100`ã€‚

```javascript
1.1 0011 0011 (0011) * 2 ^ -3
```

&emsp;&emsp;å­˜å‚¨`52`ä½ï¼Œå…¶ä½™èˆå»ï¼Œå‘å‰è¿›`1`ã€‚

```javascript
1001100110011001100110011001100110011001100110011001(10011) 
1001100110011001100110011001100110011001100110011010
```

&emsp;&emsp;;`0.2`çš„`64`ä½æµ®ç‚¹æ•°è¡¨ç¤ºã€‚

```javascript
0 01111111100 1001100110011001100110011001100110011001100110011010
```

![](/js/float/0.2.png)

&emsp;&emsp;å› æ­¤å®é™…ä¸Š`0.1`å’Œ`0.2`è½¬æ¢ä¸º`64`ä½çš„åŒç²¾åº¦æµ®ç‚¹æ•°æ—¶ï¼Œéƒ½å­˜åœ¨ç²¾åº¦æŸå¤±ã€‚

```javascript
0 01111111011 1001100110011001100110011001100110011001100110011010 // 0.1
0 01111111100 1001100110011001100110011001100110011001100110011010 // 0.2
```

> æµ®ç‚¹æ•°è¿ç®—ä¸‰æ­¥éª¤ï¼Œå¯¹é˜¶ã€æ±‚å’Œã€è§„èŒƒåŒ–

### å¯¹é˜¶

&emsp;&emsp;;`0.1`å’Œ`0.2`çš„æŒ‡æ•°éƒ¨åˆ†é˜¶æ¬¡ä¸ä¸€è‡´ï¼Œè¦å…ˆç»Ÿä¸€é˜¶æ¬¡ï¼Œä¸”éµå¾ªå°é˜¶å‘å¤§é˜¶çœ‹é½çš„åŸåˆ™ã€‚

&emsp;&emsp;æ¯”å¦‚åè¿›åˆ¶çš„`1.5 * 10 ^ 10 + 1.23 * 10 ^ 13`ï¼Œä¿ç•™å°æ•°ç‚¹å‰å`1`ä½ã€‚

 - å¤§é˜¶å‘å°é˜¶çœ‹é½æ—¶ï¼Œå³`1.5 * 10 ^ 10 + 1230 * 10 ^ 10`ï¼Œç»“æœä¸º`1231.5 * 10 ^ 10`ï¼Œè§„åˆ™èˆå¼ƒåä¸º`1.5 * 10 ^ 10`
 - å°é˜¶å‘å¤§é˜¶çœ‹é½æ—¶ï¼Œå³`0.0015 * 10 ^ 13 + 1.23 * 10 ^ 13`ï¼Œç»“æœä¸º`1.2315 * 10 ^ 13`ï¼Œè§„åˆ™èˆå¼ƒåä¸º`1.2 * 10 ^ 13`

&emsp;&emsp;æ˜æ˜¾çœ‹åˆ°å°é˜¶å‘å¤§é˜¶æ›´èƒ½æ¥è¿‘å®é™…ç»“æœã€‚å¦å¤–é˜¶æ¬¡è‹¥åŠ `1`ï¼Œå°¾æ•°ä½å°±è¦å³ç§»`1`ä½ï¼Œé˜¶æ¬¡ç›¸åŒæ—¶å¯¹é˜¶å®Œæˆã€‚

&emsp;&emsp;ä¸ºä»€ä¹ˆé˜¶æ¬¡åŠ `1`å°¾æ•°ä½å°±å³ç§»`1`ä½å‘¢ï¼Ÿ

&emsp;&emsp;;`0.1`çš„`64`ä½æµ®ç‚¹æ•°è¡¨ç¤ºï¼Œå€¼ä¸º`1.1001 1001 ... 1001 1001 1010 * 2 ^ -4`ã€‚

```javascript
0 01111111011 (1.)1001100110011001100110011001100110011001100110011010
```

&emsp;&emsp;æ­¤å¤„è‹¥é˜¶æ¬¡åŠ `1`ï¼Œè¦ä¿æŒå€¼å¤§å°ä¸å˜ï¼Œå°æ•°ç‚¹è¦å·¦ç§»`1`ä½ï¼Œå³`0.1 1001 1001 ... 1001 1001 1010 * 2 ^ -3`ï¼Œä¹Ÿå°±ç›¸å½“äºå°¾æ•°ä½å³ç§»`1`ä½ã€‚å³ç§»åç©ºä½è¡¥`1`ï¼Œä¹Ÿå°±æ˜¯çœç•¥çš„æ•´æ•°éƒ¨åˆ†çš„`1`ã€‚æ³¨æ„è‹¥è¿˜è¦å³ç§»ï¼Œç©ºä½åªèƒ½è¡¥`0`ï¼ŒåŸå› åœ¨äºæ•´æ•°éƒ¨åˆ†åç»­éƒ½æ˜¯`0`äº†ã€‚

```javascript
0 01111111110 (0.)1100110011001100110011001100110011001100110011001101(0)
```

&emsp;&emsp;å› æ­¤å¯¹é˜¶è¿‡ç¨‹å¦‚ä¸‹ï¼Œç”±äºä½ä½ä¸º`0`ï¼Œå¯ä»¥çœå»ã€‚

```javascript
0 01111111011 1001100110011001100110011001100110011001100110011010 // 0.1
0 01111111100  100110011001100110011001100110011001100110011001101(0) // é˜¶æ¬¡åŠ  1ï¼Œå°¾æ•°ä½å³ç§» 1 ä½
0 01111111100 1100110011001100110011001100110011001100110011001101 // ç©ºä½è¡¥ 1
```

> æ³¨æ„å°¾æ•°ä½å³ç§»æ˜¯å°†ä½ä½ç§»å‡ºï¼Œä¼šæŸå¤±ä¸€å®šçš„ç²¾åº¦ï¼Œä¸ºäº†å‡å°è¯¯å·®ï¼Œå°†ä¿ç•™è‹¥å¹²ç§»å‡ºçš„ä½ï¼Œåœ¨ä»¥åçš„è§„èŒƒåŒ–æ—¶å†åšèˆå…¥

### æ±‚å’Œ

&emsp;&emsp;é˜¶æ•°ç›¸åŒï¼Œå¼€å§‹æ±‚å’Œã€‚

```javascript
  0 01111111100 1100110011001100110011001100110011001100110011001101 // 0.1
+ 0 01111111100 1001100110011001100110011001100110011001100110011010 // 0.2
```

&emsp;&emsp;æ›´å¥½ç†è§£çš„æ–¹å¼ï¼Œæ³¨æ„å°¾æ•°ä½äº§ç”Ÿäº†è¿›ä½ã€‚

```javascript
  0.1100110011001100110011001100110011001100110011001101
+ 1.1001100110011001100110011001100110011001100110011010
 10.0110011001100110011001100110011001100110011001100111
```

### è§„èŒƒåŒ–

&emsp;&emsp;æ±‚å’Œç»“æœä¸º`10.0 1100 1100 ... 1100 1100 111 * 2 ^ -3`ï¼Œå³`1.00 1100 1100 ... 1100 1100 111 * 2 ^ -2`ã€‚

```javascript
1.00110011001100110011001100110011001100110011001100111
```

&emsp;&emsp;ç”±äºæŒ‡æ•°ä½åªèƒ½å®¹çº³`52`ä½ï¼Œå°±è¿‘èˆå…¥åå‘å‰è¿›`1`ã€‚

```javascript
0011001100110011001100110011001100110011001100110011(1)
0011001100110011001100110011001100110011001100110100
```

&emsp;&emsp;;`IEEE 754`çš„åŒç²¾åº¦`64`ä½è¡¨ç¤ºã€‚

```javascript
0 01111111101 0011001100110011001100110011001100110011001100110100
```

&emsp;&emsp;å³`1.0011 0011 ... 0011 0011 0100 * 2 ^ -2`ï¼Œè½¬æ¢ä¸ºåè¿›åˆ¶ä¹Ÿå°±æ˜¯`0.30000000000000004`ã€‚

### å°ç»“

&emsp;&emsp;è¦æ˜ç¡®çš„æ˜¯ï¼Œè¯¸å¦‚`0.1`ã€`0.2`ä¹‹ç±»çš„æ•°ï¼Œè™½ç„¶åœ¨åè¿›åˆ¶ä¸­èƒ½éå¸¸æ¸…æ™°åœ°è¡¨è¾¾ï¼Œä½†æ˜¯åœ¨äºŒè¿›åˆ¶ä¸­å´æ˜¯æ— ç©·å°½çš„ï¼Œæ— æ³•ç²¾ç¡®è¡¨ç¤ºã€‚è€Œ`JavaScript`éµå¾ª`IEEE 754`çš„åŒç²¾åº¦æ ‡å‡†ï¼Œä»…`64`ä½ï¼Œè¿›åˆ¶çš„è½¬æ¢ä¸­è¦èˆå¼ƒä½ä½æ¥å­˜å‚¨ï¼Œå› æ­¤å¿…ç„¶å­˜åœ¨ç²¾åº¦ä¸¢å¤±ã€‚

&emsp;&emsp;å¦å¤–åœ¨ç›¸åŠ çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹é˜¶ã€æ±‚å’Œã€è§„èŒƒåŒ–éƒ½å¯èƒ½å­˜åœ¨èˆå…¥ï¼Œä¹Ÿä¼šå­˜åœ¨ç²¾åº¦çš„ä¸¢å¤±ã€‚

## 1.005.toFixed(2)

&emsp;&emsp;;`1.005`çš„äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œ`0000 1010 0011 1101 0111`å°†æ— é™å¾ªç¯ä¸‹å»ã€‚

```javascript
1.000 (0000 1010 0011 1101 0111)
```

&emsp;&emsp;;`IEEE 754`çš„åŒç²¾åº¦`64`ä½è¡¨ç¤ºã€‚

```javascript
0 01111111111 0000000101000111101011100001010001111010111000010100(0)
0 01111111111 0000000101000111101011100001010001111010111000010100
```

&emsp;&emsp;;`1.005`æˆªæ–­åé¢ä½æ•°åï¼Œå·²ç»å°äº`1.005`ï¼Œåˆ©ç”¨ [Number.prototype.toPrecision](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Number/toPrecision) æ¥çœ‹ä¸‹`1.005`çš„`20`ä½ç²¾åº¦ã€‚

![](/js/float/1.005.png)

&emsp;&emsp;å› æ­¤`toFixed`ä¿ç•™ä¸¤ä½å°æ•°ï¼Œå››èˆäº”å…¥æ—¶ã€‚

```javascript
1.005.toFixed(2) // 1.00
```

## Number.MAX_VALUE + 1 ä¸æ˜¯ Infinity

### Number.MAX_VALUE + 1 === Number.MAX_VALUE

&emsp;&emsp;;`Number.MAX_VALUE`ä¸`1`çš„`64`ä½æµ®ç‚¹æ•°è¡¨ç¤ºä¸ºã€‚

```javascript
0 11111111110 1111111111111111111111111111111111111111111111111111 // Number.MAX_VALUE
0 01111111111 0000000000000000000000000000000000000000000000000000 // 1
```

&emsp;&emsp;ç›¸åŠ å¯¹é˜¶æ—¶`1`çš„é˜¶æ•°å°†ç”±`0`å‡åˆ°`1023`ï¼Œå°¾æ•°ä½å°†å³ç§»`1023`ä½ã€‚

```javascript
  0 11111111110 1111111111111111111111111111111111111111111111111111 // Number.MAX_VALUE
+ 0 11111111110 0000000000000000000000000000000000000000000000000000(000...0001) // 1
```

&emsp;&emsp;æ±‚å’Œã€‚

```javascript
  1.1111111111111111111111111111111111111111111111111111
+ 0.0000000000000000000000000000000000000000000000000000(000...0001)
  1.1111111111111111111111111111111111111111111111111111(000...0001)
```

&emsp;&emsp;è§„èŒƒåŒ–æ—¶ä½ä½å°†èˆå¼ƒï¼Œå®é™…ç›¸å½“äº`Number.MAX_VALUE`åŠ `0`ï¼Œæ‰€ä»¥ä¼šæœ‰ä»¥ä¸‹ç»“æœã€‚

```javascript
Number.MAX_VALUE + 1 === Number.MAX_VALUE // true
```

### 2 ^ 970

&emsp;&emsp;é‚£åˆ°åº•`Number.MAX_VALUE`åŠ ä¸Šå¤šå°‘ç­‰äº`Infinity`å‘¢ï¼Ÿ

&emsp;&emsp;æŒ‰ç…§`IEEE 754`çš„è§„èŒƒï¼Œåªè¦å¤§äºç­‰äºä»¥ä¸‹æ•°ï¼Œå°±ä¼šè¢«è¡¨ç¤ºä¸º`Infinity`ã€‚

<LaTeX>2^{E_{max}}(2-\frac{2^{1-p}}{2})</LateX>

&emsp;&emsp;;`64`ä½æµ®ç‚¹æ•°ä¸­ï¼Œ<code>E<sub>max</sub></code>ä¸º`1023`ï¼Œ`p`ä¸º`53`ã€‚

```javascript
  2 ^ 1023 * (2 - 2 ^ (1 - 53) / 2)
= 2 ^ 1023 * (2 - 2 ^ -53)
= 2 ^ 970 * (2 ^ 54 - 1)
```

&emsp;&emsp;æ­¤ç»“æœä¸`Number.MAX_VALUE`å·®å€¼ä¸ºã€‚

```javascript
  (2 ^ 54 - 1) * 2 ^ 970 - (2 ^ 53 - 1) * 2 ^ 971
= 2 ^ 970
```

&emsp;&emsp;å› æ­¤`Number.MAX_VALUE`è‡³å°‘åŠ ä¸Š`2 ^ 970`æ‰èƒ½ç­‰äº`Infinity`ã€‚

### Number.MAX_VALUE + 2 ^ 970 === Infinity

&emsp;&emsp;;`Number.MAX_VALUE`ä¸`2 ^ 970`çš„`64`ä½æµ®ç‚¹æ•°è¡¨ç¤ºã€‚

```javascript
0 11111111110 1111111111111111111111111111111111111111111111111111 // Number.MAX_VALUE
0 11111001001 0000000000000000000000000000000000000000000000000000 // 2 ^ 970
```

&emsp;&emsp;ç›¸åŠ å¯¹é˜¶æ—¶`2 ^ 970`é˜¶æ•°å°†ç”±`970`å‡åˆ°`1023`ï¼Œå·®å€¼ä¸º`53`ï¼Œå°¾æ•°ä½å°†å³ç§»`53`ä½ã€‚

```javascript
  0 11111111110 1111111111111111111111111111111111111111111111111111 // Number.MAX_VALUE
+ 0 11111111110 0000000000000000000000000000000000000000000000000000(1) // 2 ^ 970
```

&emsp;&emsp;æ±‚å’Œï¼Œå°±è¿‘èˆå…¥æ—¶ï¼Œä½ä½èˆå…¥ï¼Œå‘å‰è¿›`1`ã€‚

```javascript
  1.1111111111111111111111111111111111111111111111111111
+ 0.0000000000000000000000000000000000000000000000000000(1)
  1.1111111111111111111111111111111111111111111111111111(1)
 10.0000000000000000000000000000000000000000000000000000
```

&emsp;&emsp;æ³¨æ„å°¾æ•°ä½äº§ç”Ÿäº†è¿›ä½ï¼ŒæŒ‡æ•°ä½åˆ™åŠ `1`ï¼Œå°¾æ•°ä½å³ç§»`1`ä½ã€‚

&emsp;&emsp;ç»“æœçš„`64`ä½æµ®ç‚¹æ•°è¡¨ç¤ºï¼Œè€Œä»¥ä¸‹è¡¨ç¤ºå®é™…å°±æ˜¯`Infinity`çš„`64`ä½æµ®ç‚¹æ•°è¡¨ç¤ºã€‚

```javascript
0 11111111111 0000000000000000000000000000000000000000000000000000
```

## å‚è€ƒ

 - [JavaScript æµ®ç‚¹æ•°é™·é˜±åŠè§£æ³•](https://github.com/camsong/blog/issues/9)
 - [0.30000000000000004](https://0.30000000000000004.com/)
 - [0.1 + 0.2 ä¸ºä»€ä¹ˆä¸ç­‰äº 0.3ï¼Ÿ](https://github.com/qufei1993/Nodejs-Roadmap/blob/master/docs/javascript/floating-point-number-0.1-0.2.md)
 - [ä¸ºä»€ä¹ˆè¯´ 32 ä½æµ®ç‚¹æ•°çš„ç²¾åº¦æ˜¯ 7 ä½æœ‰æ•ˆæ•°](https://zhuanlan.zhihu.com/p/343040291)
 - [ä¸ºä»€ä¹ˆ Number.MAX_VALUE + 1 ä¸æ˜¯ Infinity?](https://www.zhihu.com/question/24423421)

##  ğŸ‰ å†™åœ¨æœ€å

ğŸ»ä¼™ä¼´ä»¬ï¼Œå¦‚æœä½ å·²ç»çœ‹åˆ°äº†è¿™é‡Œï¼Œè§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰å¸®åŠ©åˆ°ä½ çš„è¯ä¸å¦¨ç‚¹èµğŸ‘æˆ– [Star](https://github.com/dongwei1125/blog) âœ¨æ”¯æŒä¸€ä¸‹å“¦ï¼

æ‰‹åŠ¨ç å­—ï¼Œå¦‚æœ‰é”™è¯¯ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºæŒ‡æ­£ğŸ’¬~

ä½ çš„æ”¯æŒå°±æ˜¯æˆ‘æ›´æ–°çš„æœ€å¤§åŠ¨åŠ›ğŸ’ª~

[GitHub](https://github.com/dongwei1125) / [Gitee](https://gitee.com/dongwei1125)ã€[GitHub Pages](https://dongwei1125.github.io/)ã€[æ˜é‡‘](https://juejin.cn/user/2621689331987783)ã€[CSDN](https://blog.csdn.net/Don_GW) åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ˜‰~